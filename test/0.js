/*‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ*/

Object.defineProperties(global,{__:{set:v=>process.exit(_=v)},_:{set:console.log}});
Object.defineProperty(global, '$', {value:{}});

/*‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ*/

const fs = require('fs');
const path = require('path');

// –ü–æ–ª—É—á–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–∏–ª–∏ —Ç–µ–∫—É—â—É—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
const inputDir = path.resolve('../lib');

// –ò–º—è —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞ (–≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
const outputFile = path.resolve(__dirname, '1.txt');

console.log(`üìÇ –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑: ${inputDir}`);
console.log(`üìù –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤: ${outputFile}`);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
if (!fs.existsSync(inputDir) || !fs.statSync(inputDir).isDirectory()) {
    console.error('‚ùå –û—à–∏–±–∫–∞: —É–∫–∞–∑–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–∞–ø–∫–æ–π.');
    process.exit(1);
}

// –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
const files = fs.readdirSync(inputDir)
    .filter(f => {
        const fullPath = path.join(inputDir, f);
        return fs.statSync(fullPath).isFile();
    });

let result = '';

for (const file of files) {
    const fullPath = path.join(inputDir, file);
    const content = fs.readFileSync(fullPath, 'utf8');
    result += `—ç—Ç–æ —Ñ–∞–π–ª ${file}\n${content}\n\n`;
}

// –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ 1.txt –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
fs.writeFileSync(outputFile, result, 'utf8');

console.log(`‚úÖ –§–∞–π–ª ${outputFile} —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω. –î–æ–±–∞–≤–ª–µ–Ω–æ ${files.length} —Ñ–∞–π–ª–æ–≤.`);

/*

—ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∞–π–ª

—Ç–µ–ø–µ—Ä—å —á—Ç–æ –º–Ω–µ –Ω—É–∂–Ω–æ

—è —Å–µ–π—á–∞—Å —Ö–æ—á—É –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

–ù–∞–ø—Ä–∏–º–µ—Ä —è —É–∂–µ –ø—Ä–∏—à–µ–ª –∫ —Ç–æ–º—É —á—Ç–æ —É –º–µ–Ω—è –±—É–¥–µ—Ç –ø–æ–¥–æ–±–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îî‚îÄ‚îÄ lib/
    ‚îú‚îÄ‚îÄ constants.js        # –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç
    ‚îú‚îÄ‚îÄ packet-structure.js # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞
    ‚îú‚îÄ‚îÄ packet-fields.js    # –°–ø–∏—Å–∫–∏ –ø–æ–ª–µ–π –ø–∞–∫–µ—Ç–∞
    ‚îú‚îÄ‚îÄ engine.js           # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –¥–≤–∏–∂–∫–æ–≤
    ‚îú‚îÄ‚îÄ crypto-engine.js    # –î–≤–∏–∂–æ–∫ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ hash-engine.js      # –î–≤–∏–∂–æ–∫ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ sync-engine.js      # –î–≤–∏–∂–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    ‚îú‚îÄ‚îÄ encode-engine.js    # –î–≤–∏–∂–æ–∫ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ decode-engine.js    # –î–≤–∏–∂–æ–∫ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îî‚îÄ‚îÄ protocol.js         # –Ø–¥—Ä–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞


*/
